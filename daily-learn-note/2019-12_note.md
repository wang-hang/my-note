# 12月学习笔记  

## 2019.12.12  

### dart的list遍历  

想要拿到list的index, ```asMap``` 会以list下标为key

```dart
var list = [1,2,3];
list.asMap().forEach((int index, element){
  print(index);
})

```

### Dart 的widget组件是 immutable的

```dart

Widget SomeState extends State<SomeStateWidget>{
  Widget SomeWidget = SomeWidget(someProperty: 'xxx');

  void doSomething(){
    setState((){
      SomeWidget.someProperty = 'new value'; // 这种写法flutter会认为SomeWidget没有改变 不会执行rebuild方法
      myWidget = SomeWidget(someProperty: 'new value'); // 这种写法是正确的 每次setState都会重新build
    });
  }
}

// 原bug代码

class HomeState extends State<HomePage>{
  List<Widget> _pageList = [TodoPage(todoList: _todoList), OtherPage()];
  int _activeIndex;
  List _todoList = []

  @override
  Widget build(){
    return Scaffold(
      body: _pageList.element(_activeIndex), // 问题所在 每次Home rebuild时_pageList内的widget实例被缓存了不会重新对其build
      body: _buildPage(_activeIndex), // 解决办法: 每次Home build时这也重新build
      // ...
    );
  }

  Widget _buildPage(int index){
    // ...
    return SomeWidget()
  }

}

```
